# ATM Console App (Final Project)

Консольное приложение-банкомат: регистрация клиентов, вход по карте+PIN, пополнение/снятие, перевод, мини-выписка (5 последних операций), просмотр сведений о клиенте и даты создания счёта.

## Требования и запуск

### JDK
Проект использует **Java Text Blocks** (`""" ... """`) в `DisplayInfo`, поэтому нужен **JDK 15+**.  
Рекомендуется JDK 17 или выше.

Text Blocks являются стандартной фичей, начиная с Java 15.  
Источник: Baeldung (Text Blocks) — since Java 15.

### Запуск в IDE (IntelliJ IDEA)
1. Убедись, что Project SDK = 15+.
2. Запусти `finalproject.StartMenu`.

### Запуск из консоли (пример)
```bash
javac -version
java -version
java finalproject.StartMenu
```

## Где лежит файл данных (JSON)

Данные сохраняются в файл:
`{user.home}/finalhomeproject/dataFile.json`

### Примеры путей
- Windows: `C:\Users\<User>\finalhomeproject\dataFile.json`
- macOS: `/Users/<User>/finalhomeproject/dataFile.json`
- Linux: `/home/<User>/finalhomeproject/dataFile.json`

## Формат данных (JSON контракт)

В файле хранится JSON-объект, где:
- ключ: `userCardNumber` (строка из 8 цифр)
- значение: объект `Client`

### Схема (упрощённо):
```json
{
  "12345678": {
    "firstName": "...",
    "transactions": [
      { "message": "...", "dateTime": "..." }
    ]
  }
}
```

```md
- `createdAt` — дата/время создания счёта (устанавливается один раз при регистрации).
- `transactions` — список последних 5 операций (сохраняется между запусками).
- JSON записывается в «pretty» виде (читаемый формат) через `Gson setPrettyPrinting()`.
```

## Основные сценарии

1. Регистрация клиента — Главное меню → `1` → ввод данных.
2. Вход — Главное меню → `2` → карта → PIN.
3. Пополнение / Снятие / Перевод — В меню клиента выбираем операцию → `3` → после операции баланс меняется, а в историю добавляется запись.
4. Мини-выписка — Меню клиента → `4` → «Мини-выписка» → вывод до 5 последних операций.
5. Дата создания счёта — Меню клиента → `5` → «Дата и время создания карт-счёта» → вывод createdAt.
6. Выход и сохранение — Главное меню → `6` → «Завершить работу» → данные сохраняются в JSON.

## Ограничения и форматы ввода

### Формат данных
- Имя/Фамилия/Город: латиница, первая заглавная, длина 2..21 (см. regex в DataValidation).
- Телефон: ровно 7 цифр.
- Номер карты: ровно 8 цифр.
- PIN: ровно 4 цифры.
- Для выхода из ввода в большинстве полей можно ввести слово: `Exit`.

### Лимиты операций
- Пополнение: 1..10000
- Снятие: 1..2000
- Перевод: 1..1000

## Настройка вывода (цвета)

По умолчанию приложение использует ANSI-цвета.
Можно отключить цвета:
1. Переменной окружения `NO_COLOR` (любое непустое значение), или
2. Системным свойством JVM: `-Dno.color=true`
3. Спецификация поведения `NO_COLOR`: если переменная установлена — стилизация подавляется.

### Пример:
```bash
NO_COLOR=1 java finalproject.StartMenu
```

или

```bash
java -Dno.color=true finalproject.StartMenu
```

## Архитектура (кратко)

- `Controller` (core) — сценарии/меню, оркестрация, работа с клиентами.
- `DataValidation` (core) — ввод, проверки форматов, ограничения, обработка ошибок выбора.
- `DisplayInfo` (ui) — весь вывод/сообщения и меню.
- `FileTransfer` (dto/storage) — загрузка/сохранение JSON в `Map<String, Client`>.

## Хранение

- `В памяти` — DataClientCreation (обёртка над `Map<String, Client>`).
- `На диске` — JSON файл (см. выше).

## Известные моменты

- Формат имён сейчас только латиница (можно расширить под кириллицу при необходимости).
- Логи валидации идут через `java.util.logging (JUL)` в DataValidation.
